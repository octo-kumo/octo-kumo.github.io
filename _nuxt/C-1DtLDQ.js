const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./KrjQ03nw.js","./mpRoWkBO.js","./Cdy4ovlM.js","./entry.DPOKIEAV.css","./BSZFgSs5.js","./B9uXPSTl.js","./CV4Hssdo.js","./CE1G-McA.js"])))=>i.map(i=>d[i]);
import{a as L,b as $}from"./DNcyRecw.js";import{E as U}from"./9owE_yBM.js";import{D as P}from"./mpRoWkBO.js";import{_ as j}from"./Cbb__PsO.js";import{u as z}from"./CetKUzrm.js";import{b as V,Z as F,w as J,r as K,M as b,J as H,a as y,u as a,a3 as Y,d as W,e as R,U as B,c as C,O as r,P as u,F as k,_ as T,L as D,k as Z,K as E}from"./Cdy4ovlM.js";import{E as G}from"./ONyplbQA.js";import{E as Q,$ as X,a0 as ee}from"./CXgh2bVR.js";import{E as te}from"./DVeqoeK3.js";import{E as oe,a as ae}from"./CoI4KJJk.js";import{E as ne}from"./CJN6Q2WT.js";import"./DM9fvJ3D.js";import"./C12MRI7F.js";/* empty css        */import{E as se}from"./CvYC8Xmx.js";import{u as le}from"./DdTJF8aR.js";import{s as re}from"./BTz8rrz7.js";import"./hT5EZHBq.js";import"./Cq9Fpw4b.js";import"./BWHN3Fq2.js";import"./Bu0khPrm.js";import"./CNFK1gg8.js";import"./C8b4-tx9.js";import"./C4GAp2rc.js";import"./CDCU4beR.js";import"./CSF8GnY5.js";import"./CKYzR6Dw.js";import"./DI9FKtlJ.js";import"./DO6_CzPN.js";import"./CtN2CsmN.js";import"./56rOo4GG.js";import"./lEc_mr0M.js";import"./DdjagA1o.js";import"./CM9Vt25o.js";import"./Bj2b9i9X.js";import"./D7SBKgv0.js";import"./BUADUvnR.js";import"./BB_Ol6Sd.js";import"./zcHPfVOM.js";import"./BwwvTQnZ.js";import"./Bsm-pjvr.js";import"./CZN8bR6y.js";import"./CNN4MVuY.js";import"./Bp3YSIOJ.js";import"./B3lhUXGt.js";import"./BmU_cfaq.js";import"./BSZFgSs5.js";import"./CV4Hssdo.js";import"./B9uXPSTl.js";import"./CPeR6xjG.js";import"./B2_D2k1b.js";import"./hWEbwS_-.js";import"./B2bONxHh.js";import"./DIhoAStX.js";import"./DCTLXrZ8.js";import"./D7ee5kX0.js";const ie={__name:"MDC",props:{tag:{type:[String,Boolean],default:"div"},value:{type:[String,Object],required:!0},excerpt:{type:Boolean,default:!1},parserOptions:{type:Object,default:()=>({})},class:{type:[String,Array,Object],default:""},unwrap:{type:[Boolean,String],default:!1},cacheKey:{type:String,default:void 0},partial:{type:Boolean,default:!0}},async setup(c){let n,o;const e=c,i=V(()=>e.cacheKey??m(e.value)),{data:t,refresh:s,error:_}=([n,o]=F(async()=>z(i.value,async()=>{if(typeof e.value!="string")return e.value;const{parseMarkdown:p}=await P(async()=>{const{parseMarkdown:l}=await import("./KrjQ03nw.js").then(d=>d.i);return{parseMarkdown:l}},__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url);return await p(e.value,{...e.parserOptions,toc:e.partial?!1:e.parserOptions?.toc,contentHeading:e.partial?!1:e.parserOptions?.contentHeading})},"$R23qlhow_i")),n=await n,o(),n),v=V(()=>e.excerpt?t.value?.excerpt:t.value?.body);J(()=>e.value,()=>{s()});function m(p){typeof p!="string"&&(p=JSON.stringify(p||""));let l=0;for(let d=0;d<p.length;d++){const h=p.charCodeAt(d);l=(l<<6)-l+h,l=l&l}return`mdc-${l===0?"0000":l.toString(36)}-key`}return(p,l)=>{const d=j;return K(p.$slots,"default",{data:a(t)?.data,body:a(t)?.body,toc:a(t)?.toc,excerpt:a(t)?.excerpt,error:a(_)},()=>[v.value?(y(),b(d,{key:0,tag:e.tag,class:Y(e.class),body:v.value,data:a(t)?.data,unwrap:e.unwrap},null,8,["tag","class","body","data","unwrap"])):H("",!0)])}}};class me extends TransformStream{#e="";constructor(n={allowCR:!1}){super({transform:(o,e)=>{for(o=this.#e+o;;){const i=o.indexOf(`
`),t=n.allowCR?o.indexOf("\r"):-1;if(t!==-1&&t!==o.length-1&&(i===-1||i-1>t)){e.enqueue(o.slice(0,t)),o=o.slice(t+1);continue}if(i===-1)break;const s=o[i-1]==="\r"?i-1:i;e.enqueue(o.slice(0,s)),o=o.slice(i+1)}this.#e=o},flush:o=>{if(this.#e==="")return;const e=n.allowCR&&this.#e.endsWith("\r")?this.#e.slice(0,-1):this.#e;o.enqueue(e)}})}}function pe(c){let n=new TextDecoderStream,o=new me({allowCR:!0});return c.pipeThrough(n).pipeThrough(o)}function ue(c){let o=/[:]\s*/.exec(c),e=o&&o.index;if(e)return[c.substring(0,e),c.substring(e+o[0].length)]}async function*ce(c,n){if(!c.body)return;let o=pe(c.body),e,i=o.getReader(),t;for(;;){if(n&&n.aborted)return i.cancel();if(e=await i.read(),e.done)return;if(!e.value){t&&(yield t),t=void 0;continue}let[s,_]=ue(e.value)||[];s&&(s==="data"?(t||={},t[s]=t[s]?t[s]+`
`+_:_):s==="event"?(t||={},t[s]=_):s==="id"?(t||={},t[s]=+_||_):s==="retry"&&(t||={},t[s]=+_||void 0))}}const de={class:"flex flex-1 gap-2"},fe=W({__name:"chat",setup(c){const n=R(""),o=R(!1),e=B({stream:!0,max_tokens:256,messages:le("chat-messages",[{role:"system",content:"You are a helpful assistant"}])}),i=["system","user","assistant"],t=B([]),s=()=>{n.value.length>0&&(e.messages.push({role:"user",content:n.value}),n.value=""),t.splice(0,t.length),o.value=!0;const v=new AbortController;re(fetch("https://ai.yun.ng/chat",{method:"POST",signal:v.signal,body:JSON.stringify(e)})).then(async m=>{let p=ce(m,v.signal);const l={role:"assistant",content:""};e.messages.push(l);const d=e.messages.length-1;for await(let h of p)h.data&&(h.data==="[DONE]"?console.log("hooray!",l.content,typeof l.content):e.messages[d].content+=JSON.parse(h.data).response)}).catch(m=>se.error(m.message)).finally(()=>o.value=!1)};function _(){e.messages.splice(0,e.messages.length),e.messages.push({role:"system",content:"You are a helpful assistant"})}return(v,m)=>{const p=$,l=L,d=U,h=ie,M=G,N=X,S=Q,x=te,q=ee,w=oe,A=ae,I=ne;return y(),C(k,null,[r(A,{model:a(e),"label-width":"auto"},{default:u(()=>[(y(!0),C(k,null,T(a(e).messages,(O,f)=>(y(),b(w,null,{label:u(()=>[r(l,{modelValue:a(e).messages[f].role,"onUpdate:modelValue":g=>a(e).messages[f].role=g,placeholder:"Role",style:{width:"90px"},size:"small"},{default:u(()=>[(y(),C(k,null,T(i,g=>r(p,{key:g,label:g,value:g},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),default:u(()=>[D("div",de,[a(t)[f]?(y(),b(d,{key:0,type:"textarea",modelValue:a(e).messages[f].content,"onUpdate:modelValue":g=>a(e).messages[f].content=g,placeholder:"Content",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"])):a(e).messages[f].content?(y(),b(h,{key:1,class:"flex-1 chat-msg md-content",value:a(e).messages[f].content||"..."},null,8,["value"])):(y(),b(M,{key:2,rows:1})),r(x,{onClick:g=>a(t)[f]=!a(t)[f],size:"small",type:a(t)[f]?"primary":""},{default:u(()=>[r(S,null,{default:u(()=>[r(N)]),_:1})]),_:2},1032,["onClick","type"]),r(x,{onClick:g=>a(e).messages.splice(f,1),size:"small",class:"ml-0!"},{default:u(()=>[r(S,null,{default:u(()=>[r(q)]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024))),256)),r(w,{label:"Prompt"},{default:u(()=>[r(d,{modelValue:a(n),"onUpdate:modelValue":m[0]||(m[0]=O=>Z(n)?n.value=O:null),type:"textarea",rows:3,minlength:"1",disabled:a(o)},null,8,["modelValue","disabled"])]),_:1}),r(w,{label:" "},{default:u(()=>[r(x,{type:"primary",onClick:s,disabled:a(o)},{default:u(()=>[...m[1]||(m[1]=[E(" Send! ",-1)])]),_:1},8,["disabled"]),r(x,{type:"danger",onClick:_,disabled:a(o)},{default:u(()=>[...m[2]||(m[2]=[E(" Clear! ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"]),r(I,null,{default:u(()=>[...m[3]||(m[3]=[E(" Model: ",-1),D("code",null,"qwen1.5-14b-chat-awq",-1)])]),_:1})],64)}}}),yt=Object.assign(fe,{__name:"AiChat"});export{yt as default};
